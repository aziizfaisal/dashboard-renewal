<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Dashboard ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        margin: 0;
        padding: 20px;
    }
    h1 {
        text-align: center;
        color: #333;
    }
    .input-area {
        width: 95%;
        margin: 0 auto 20px auto;
        text-align: center;
    }
    .input-area label {
        font-weight: bold;
        margin-left: 10px;
    }
    .input-area input[type="text"] {
        width: 180px;
        padding: 7px;
        font-size: 1em;
        margin-left: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
        text-align: center;
    }
    table {
        width: 95%;
        margin: 20px auto;
        border-collapse: collapse;
        background: #fff;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    th, td {
        padding: 12px 15px;
        text-align: center;
        border-bottom: 1px solid #ddd;
    }
    th {
        background: #007BFF;
        color: #fff;
    }
    tr:hover {
        background: #f1f1f1;
    }
    input[type="number"] {
        width: 60px;
        padding: 5px;
        text-align: center;
        border-radius: 5px;
        border: 1px solid #ccc;
    }
    .progress-container {
        width: 100%;
        background: #ddd;
        border-radius: 10px;
        height: 20px;
        overflow: hidden;
    }
    .progress-bar {
        height: 100%;
        width: 0%;
        border-radius: 10px;
        text-align: right;
        padding-right: 5px;
        color: white;
        font-weight: bold;
        line-height: 20px;
        transition: width 0.5s, background 0.5s;
    }
    .bestOne {
        color: green;
        font-weight: bold;
        font-size: 18px;
    }
    .worstOne {
        color: #af1c1c;
        font-weight: bold;
        font-size: 18px;
    }
    .dangerOne {
        color: orange;
        font-weight: bold;
        font-size: 18px;
    }
</style>
</head>
<body>

<h1>Dashboard ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø§Ù„Ù‡Ø¯Ù 40%</h1>

<div class="input-area">
    <label for="first-name">Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ (Ø§ÙƒØªØ¨ Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø£Ùˆ Ø§Ù„Ø­Ø±ÙˆÙ):</label>
    <input type="text" id="first-name" value="Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹Ù†Ø²ÙŠ">
</div>

<table id="dashboard">
    <thead>
        <tr>
            <th>Ø§Ù„Ù…ÙˆØ¸Ù</th>
            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠ</th>
            <th>Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯</th>
            <th>Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„ØªØ¬Ø¯ÙŠØ¯ 40%</th>
            <th>ØªØ¨Ù‚Ù‰ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‡Ø¯Ù</th>
            <th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</th>
            <th>Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„ØªÙˆØªØ§Ù„</th>
            <th>Ø£ÙØ¶Ù„ ÙˆØ§Ø­Ø¯</th>
            <th>ÙÙŠ Ø®Ø·Ø±</th>
            <th>Ø³ÙŠØ¡</th>
        </tr>
    </thead>
    <tbody>
        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„Ù€ JavaScript -->
    </tbody>
</table>

<script>
let employees = [
    {name: "Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹Ù†Ø²ÙŠ", total: 115, new: 30},
    {name: "Ø±Ø§ÙƒØ§Ù† Ø§Ù„Ø±Ù…ÙŠØ¯", total: 112, new: 23},
    {name: "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø§Ù„Ø¹Ø¨Ø§Ø¯", total: 114, new: 21},
    {name: "ÙˆÙ„ÙŠØ¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ", total: 113, new: 25},
    {name: "Ù†Ø§ÙŠÙ", total: 111, new: 24},
];

const tbody = document.querySelector("#dashboard tbody");
const firstNameInput = document.getElementById("first-name");

firstNameInput.addEventListener("input", () => {
    employees[0].name = firstNameInput.value;
    renderTable();
});

function renderTable() {
    tbody.innerHTML = "";

    employees.forEach(emp => {
        emp.target = Math.ceil(emp.total * 0.40);
        emp.remaining = Math.max(emp.target - emp.new, 0);
        emp.progressPercent = Math.min((emp.new / emp.target) * 100, 100);
        emp.currentPercent = ((emp.new / emp.total) * 100).toFixed(1);
    });

    // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø­Ø³Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ù„Ù„Ù‡Ø¯Ù
    employees.sort((a, b) => b.progressPercent - a.progressPercent);

    // ØªØ­Ø¯ÙŠØ¯ Ø£ÙØ¶Ù„ ÙˆØ§Ø­Ø¯ (Ø£Ø¹Ù„Ù‰ progressPercent)
    let bestIndex = 0;
    let maxProgress = employees[0].progressPercent;
    for(let i=1; i<employees.length; i++) {
        if(employees[i].progressPercent > maxProgress) {
            maxProgress = employees[i].progressPercent;
            bestIndex = i;
        }
    }
    // ØªØ­Ø¯ÙŠØ¯ Ø£Ø³ÙˆØ£ ÙˆØ§Ø­Ø¯ (Ø£Ù‚Ù„ progressPercent)
    let worstIndex = 0;
    let minProgress = employees[0].progressPercent;
    for(let i=1; i<employees.length; i++) {
        if(employees[i].progressPercent < minProgress) {
            minProgress = employees[i].progressPercent;
            worstIndex = i;
        }
    }
    // ØªØ­Ø¯ÙŠØ¯ "ÙÙŠ Ø®Ø·Ø±" (Ù‚Ø¨Ù„ Ø§Ù„Ø£Ø®ÙŠØ±)
    let dangerIndex = (employees.length > 2) ? employees.length - 2 : null;

    employees.forEach((emp, index) => {
        let color;
        if(emp.progressPercent < 50) color = "red";
        else if(emp.progressPercent < 80) color = "orange";
        else color = "green";

        const bestOne = (index === bestIndex) ? '<span class="bestOne">âœ” Ø§Ù„Ø£ÙØ¶Ù„</span>' : '';
        const dangerOne = (index === dangerIndex) ? '<span class="dangerOne">âš ï¸ ÙÙŠ Ø®Ø·Ø±</span>' : '';
        const worstOne = (index === worstIndex) ? '<span class="worstOne">ğŸ›‘ Ø³ÙŠØ¡</span>' : '';

        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${emp.name}</td>
            <td>${emp.total}</td>
            <td><input type="number" min="0" value="${emp.new}" data-index="${index}"></td>
            <td>${emp.target}</td>
            <td>${emp.remaining}</td>
            <td>
                <div class="progress-container">
                    <div class="progress-bar" style="width: ${emp.progressPercent}%; background: ${color}">
                        ${emp.progressPercent.toFixed(0)}%
                    </div>
                </div>
            </td>
            <td>${emp.currentPercent}%</td>
            <td>${bestOne}</td>
            <td>${dangerOne}</td>
            <td>${worstOne}</td>
        `;
        tbody.appendChild(tr);
    });

    document.querySelectorAll('input[type="number"]').forEach(input => {
        input.addEventListener('input', (e) => {
            const idx = e.target.dataset.index;
            employees[idx].new = parseInt(e.target.value) || 0;
            renderTable();
        });
    });
}

renderTable();
</script>

</body>
</html>
