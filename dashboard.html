<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ø­Ø¬ÙˆØ²Ø§Øª ØµØ§Ù„ÙˆÙ† Ø±Ø¬Ø§Ù„ÙŠ</title>
<style>
body { font-family: Arial; margin:0; background:#111; color:#fff; direction:rtl; }
header { background:#222; padding:20px; text-align:center; border-bottom:3px solid #d4a056; }
header .logo { font-size:28px; font-weight:bold; color:#d4a056; }
.container { width:90%; margin:30px auto; max-width:700px; background:#1a1a1a; padding:20px; border-radius:10px; border:1px solid #333; }
h2 { color:#d4a056; text-align:center; margin-bottom:20px; }
input, select, button { width:100%; padding:12px; border-radius:6px; border:none; margin-top:6px; font-size:16px; }
input, select { background:#333; color:#fff; }
button { background:#d4a056; color:black; font-weight:bold; cursor:pointer; }
button:hover { background:#c79542; }
.success { display:none; text-align:center; margin-top:20px; padding:12px; background:#0f0; color:black; border-radius:8px; }
</style>
</head>
<body>

<header><div class="logo">ðŸ’ˆ ØµØ§Ù„ÙˆÙ† Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠ</div></header>

<div class="container">
<h2>Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ</h2>
<label>Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="name">
<label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label><input type="text" id="phone">
<label>Ø§Ù„Ø®Ø¯Ù…Ø©</label><input type="text" id="service" readonly value="Ø­Ù„Ø§Ù‚Ø© Ø´Ø¹Ø±">
<label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input type="date" id="date">
<label>Ø§Ù„ÙˆÙ‚Øª</label>
<select id="time">
<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª</option>
<option>2:00 PM</option>
<option>3:00 PM</option>
<option>4:00 PM</option>
<option>5:00 PM</option>
<option>6:00 PM</option>
<option>7:00 PM</option>
<option>8:00 PM</option>
</select>
<button id="bookBtn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button>
<div class="success" id="successMsg">ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø²Ùƒ Ø¨Ù†Ø¬Ø§Ø­! ðŸ’ˆ</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";
import emailjs from "https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyA1pDgSGAMKdceGERXgIU9TQ9AN6iTmquM",
  authDomain: "salonbookingdashboard.firebaseapp.com",
  databaseURL: "https://salonbookingdashboard-default-rtdb.firebaseio.com/",
  projectId: "salonbookingdashboard",
  storageBucket: "salonbookingdashboard.appspot.com",
  messagingSenderId: "38824070536",
  appId: "1:38824070536:web:fff486776f347333a73e3d"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// EmailJS init
emailjs.init("JUgXTktPdJchfe-PS");

// Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage
let bookedAppointments = JSON.parse(localStorage.getItem("bookedAppointments") || "[]");

document.getElementById("bookBtn").addEventListener("click", () => {
    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const service = document.getElementById("service").value.trim();
    const date = document.getElementById("date").value;
    const time = document.getElementById("time").value;

    if (!name || !phone || !service || !date || !time) { alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„."); return; }

    const exists = bookedAppointments.some(app => app.date === date && app.time === time);
    if (exists) { alert("Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ù…Ø­Ø¬ÙˆØ² Ù…Ø³Ø¨Ù‚Ø§Ù‹."); return; }

    bookedAppointments.push({date, time});
    localStorage.setItem("bookedAppointments", JSON.stringify(bookedAppointments));

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¬Ø² ÙÙŠ Firebase
    const bookingsRef = ref(db, 'bookings');
    push(bookingsRef, {name, phone, service, date, time});

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯
    emailjs.send("service_e73lp4a", "template_p39rn1c", {name, phone, service, date, time})
        .then(() => { 
            document.getElementById("successMsg").style.display = "block"; 
            setTimeout(()=>{ document.getElementById("successMsg").style.display="none"; }, 4000);
        });
});
</script>

</body>
</html>
